resource "kubernetes_ingress_v1" "example_ingress" {
  metadata {
    name = "example-ingress"
    namespace = "tst-ns-tfm"
    annotations = {
      "kubernetes.io/ingress.class" = "nginx",
      "cert-manager.io/cluster-issuer" = "syndeno-issuer"
      "kubernetes.io/ingress.allow-http" = "false"
      "nginx.ingress.kubernetes.io/proxy-body-size" = "0"
    }
  }

  spec {
    # backend {
    #   service_name = "${var.deployment_name}-np"
    #   service_port = 80
    # }
    rule {
      host = "nginx.plt.aw.syndeno.net"
      http {
        path {
          backend {
            service {
              name = "myapp-1"
              port {
                number = 8080
              }
            }
          }

          path = "/"
        }

      }
    }

    tls {
      hosts = ["nginx.plt.aw.syndeno.net"]
      secret_name = "nginx.plt.aw.syndeno.net"
    }
  }
}
